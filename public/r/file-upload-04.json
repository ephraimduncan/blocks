{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "file-upload-04",
  "type": "registry:block",
  "title": "File Upload Drag & Drop",
  "description": "A file upload drag & drop block.",
  "author": "ephraim duncan <https://ephraimduncan.com>",
  "registryDependencies": [
    "button",
    "card",
    "progress"
  ],
  "dependencies": [
    "lucide-react",
    "sonner"
  ],
  "files": [
    {
      "path": "content/components/file-upload/file-upload-04.tsx",
      "type": "registry:component",
      "target": "components/file-upload-04.tsx",
      "content": "\"use client\";\r\n\r\nimport { File, FileSpreadsheet, X } from \"lucide-react\";\r\nimport { ChangeEvent, DragEvent, useRef, useState } from \"react\";\r\nimport { toast } from \"sonner\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card } from \"@/components/ui/card\";\r\nimport { Progress } from \"@/components/ui/progress\";\r\n\r\nexport default function FileUpload04() {\r\n  const [uploadState, setUploadState] = useState<{\r\n    file: File | null;\r\n    progress: number;\r\n    uploading: boolean;\r\n  }>({\r\n    file: null,\r\n    progress: 0,\r\n    uploading: false,\r\n  });\r\n  const [showDummy, setShowDummy] = useState(true);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const validFileTypes = [\r\n    \"text/csv\",\r\n    \"application/vnd.ms-excel\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\r\n  ];\r\n\r\n  const handleFile = (file: File | undefined) => {\r\n    if (!file) return;\r\n\r\n    if (validFileTypes.includes(file.type)) {\r\n      setUploadState({ file, progress: 0, uploading: true });\r\n\r\n      const interval = setInterval(() => {\r\n        setUploadState((prev) => {\r\n          const newProgress = prev.progress + 5;\r\n          if (newProgress >= 100) {\r\n            clearInterval(interval);\r\n            return { ...prev, progress: 100, uploading: false };\r\n          }\r\n          return { ...prev, progress: newProgress };\r\n        });\r\n      }, 200);\r\n    } else {\r\n      toast.error(\"Please upload a CSV, XLSX, or XLS file.\", {\r\n        position: \"bottom-right\",\r\n        duration: 3000,\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleFileChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n    handleFile(event.target.files?.[0]);\r\n  };\r\n\r\n  const handleDrop = (event: DragEvent<HTMLDivElement>) => {\r\n    event.preventDefault();\r\n    handleFile(event.dataTransfer.files?.[0]);\r\n  };\r\n\r\n  const resetFile = () => {\r\n    setUploadState({ file: null, progress: 0, uploading: false });\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = \"\";\r\n    }\r\n  };\r\n\r\n  const getFileIcon = () => {\r\n    if (!uploadState.file) return <File />;\r\n\r\n    const fileExt = uploadState.file.name.split(\".\").pop()?.toLowerCase() || \"\";\r\n    return [\"csv\", \"xlsx\", \"xls\"].includes(fileExt) ? (\r\n      <FileSpreadsheet className=\"h-5 w-5 text-foreground\" />\r\n    ) : (\r\n      <File className=\"h-5 w-5 text-foreground\" />\r\n    );\r\n  };\r\n\r\n  const formatFileSize = (bytes: number) => {\r\n    if (bytes === 0) return \"0 Bytes\";\r\n    const k = 1024;\r\n    const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\"];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + \" \" + sizes[i];\r\n  };\r\n\r\n  const { file, progress, uploading } = uploadState;\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-center p-10 w-full max-w-lg\">\r\n      <form className=\"w-full\" onSubmit={(e) => e.preventDefault()}>\r\n        <h3 className=\"text-lg font-semibold text-foreground\">File Upload</h3>\r\n\r\n        <div\r\n          className=\"flex justify-center rounded-md border mt-2 border-dashed border-input px-6 py-12\"\r\n          onDragOver={(e) => e.preventDefault()}\r\n          onDrop={handleDrop}\r\n        >\r\n          <div>\r\n            <File\r\n              className=\"mx-auto h-12 w-12 text-muted-foreground\"\r\n              aria-hidden={true}\r\n            />\r\n            <div className=\"flex text-sm leading-6 text-muted-foreground\">\r\n              <p>Drag and drop or</p>\r\n              <label\r\n                htmlFor=\"file-upload-03\"\r\n                className=\"relative cursor-pointer rounded-sm pl-1 font-medium text-primary hover:underline hover:underline-offset-4\"\r\n              >\r\n                <span>choose file</span>\r\n                <input\r\n                  id=\"file-upload-03\"\r\n                  name=\"file-upload-03\"\r\n                  type=\"file\"\r\n                  className=\"sr-only\"\r\n                  accept=\".csv, .xlsx, .xls\"\r\n                  onChange={handleFileChange}\r\n                  ref={fileInputRef}\r\n                />\r\n              </label>\r\n              <p className=\"pl-1\">to upload</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <p className=\"mt-2 text-xs leading-5 text-muted-foreground sm:flex sm:items-center sm:justify-between\">\r\n          <span>Accepted file types: CSV, XLSX or XLS files.</span>\r\n          <span className=\"pl-1 sm:pl-0\">Max. size: 10MB</span>\r\n        </p>\r\n\r\n        {!file && showDummy && (\r\n          <Card className=\"relative mt-8 bg-muted p-4 gap-4\">\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className=\"absolute right-1 top-1 h-8 w-8 text-muted-foreground hover:text-foreground\"\r\n              aria-label=\"Remove\"\r\n              onClick={() => setShowDummy(false)}\r\n            >\r\n              <X className=\"h-5 w-5 shrink-0\" aria-hidden={true} />\r\n            </Button>\r\n\r\n            <div className=\"flex items-center space-x-2.5\">\r\n              <span className=\"flex h-10 w-10 shrink-0 items-center justify-center rounded-sm bg-background shadow-sm ring-1 ring-inset ring-border\">\r\n                <FileSpreadsheet\r\n                  className=\"h-5 w-5 text-foreground\"\r\n                  aria-hidden={true}\r\n                />\r\n              </span>\r\n              <div>\r\n                <p className=\"text-xs font-medium text-foreground\">\r\n                  Revenue_Q1_2024.xlsx\r\n                </p>\r\n                <p className=\"mt-0.5 text-xs text-muted-foreground\">3.1 MB</p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-3\">\r\n              <Progress value={45} className=\"h-1.5\" />\r\n              <span className=\"text-xs text-muted-foreground\">45%</span>\r\n            </div>\r\n          </Card>\r\n        )}\r\n\r\n        {file && (\r\n          <Card className=\"relative mt-8 bg-muted p-4 gap-4\">\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className=\"absolute right-1 top-1 h-8 w-8 text-muted-foreground hover:text-foreground\"\r\n              aria-label=\"Remove\"\r\n              onClick={resetFile}\r\n            >\r\n              <X className=\"h-5 w-5 shrink-0\" aria-hidden={true} />\r\n            </Button>\r\n\r\n            <div className=\"flex items-center space-x-2.5\">\r\n              <span className=\"flex h-10 w-10 shrink-0 items-center justify-center rounded-sm bg-background shadow-sm ring-1 ring-inset ring-border\">\r\n                {getFileIcon()}\r\n              </span>\r\n              <div>\r\n                <p className=\"text-xs font-medium text-foreground\">\r\n                  {file?.name}\r\n                </p>\r\n                <p className=\"mt-0.5 text-xs text-muted-foreground\">\r\n                  {file && formatFileSize(file.size)}\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-3\">\r\n              <Progress value={progress} className=\"h-1.5\" />\r\n              <span className=\"text-xs text-muted-foreground\">{progress}%</span>\r\n            </div>\r\n          </Card>\r\n        )}\r\n\r\n        <div className=\"mt-8 flex items-center justify-end space-x-3\">\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            className=\"whitespace-nowrap\"\r\n            onClick={resetFile}\r\n            disabled={!file}\r\n          >\r\n            Cancel\r\n          </Button>\r\n          <Button\r\n            type=\"submit\"\r\n            className=\"whitespace-nowrap\"\r\n            disabled={!file || uploading || progress < 100}\r\n          >\r\n            Upload\r\n          </Button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"
    }
  ],
  "categories": [
    "file-upload"
  ]
}