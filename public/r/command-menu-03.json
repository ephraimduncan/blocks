{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "command-menu-03",
  "type": "registry:block",
  "title": "Command Menu with Documentation Search",
  "description": "A command menu with documentation search block.",
  "author": "ephraim duncan <https://ephraimduncan.com>",
  "registryDependencies": [
    "button",
    "command",
    "dialog",
    "separator"
  ],
  "dependencies": [
    "@tabler/icons-react"
  ],
  "files": [
    {
      "path": "content/components/command-menu/command-menu-03.tsx",
      "type": "registry:component",
      "target": "components/command-menu-03.tsx",
      "content": "\"use client\";\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { IconArrowRight, IconCornerDownLeft } from \"@tabler/icons-react\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"@/components/ui/command\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Separator } from \"@/components/ui/separator\";\n\nconst navItems = [\n  { href: \"/\", label: \"Home\", keywords: [\"home\", \"main\", \"index\"] },\n  {\n    href: \"/dashboard\",\n    label: \"Dashboard\",\n    keywords: [\"dashboard\", \"overview\"],\n  },\n  {\n    href: \"/settings\",\n    label: \"Settings\",\n    keywords: [\"settings\", \"preferences\"],\n  },\n];\n\nconst pageGroups = [\n  {\n    name: \"Getting Started\",\n    pages: [\n      {\n        name: \"Introduction\",\n        href: \"/docs/introduction\",\n        keywords: [\"intro\", \"start\"],\n      },\n      {\n        name: \"Installation\",\n        href: \"/docs/installation\",\n        keywords: [\"install\", \"setup\"],\n      },\n      {\n        name: \"Quick Start\",\n        href: \"/docs/quick-start\",\n        keywords: [\"quick\", \"begin\"],\n      },\n    ],\n  },\n  {\n    name: \"Utilities\",\n    pages: [\n      {\n        name: \"Typography\",\n        href: \"/docs/utilities/typography\",\n        keywords: [\"text\", \"font\"],\n      },\n      {\n        name: \"Colors\",\n        href: \"/docs/utilities/colors\",\n        keywords: [\"color\", \"theme\"],\n      },\n      {\n        name: \"Spacing\",\n        href: \"/docs/utilities/spacing\",\n        keywords: [\"margin\", \"padding\"],\n      },\n    ],\n  },\n];\n\nconst colorGroups = [\n  {\n    name: \"Neutral\",\n    colors: [\n      {\n        name: \"Neutral 50\",\n        className: \"neutral-50\",\n        value: \"oklch(0.985 0 0)\",\n      },\n      {\n        name: \"Neutral 100\",\n        className: \"neutral-100\",\n        value: \"oklch(0.97 0 0)\",\n      },\n      {\n        name: \"Neutral 200\",\n        className: \"neutral-200\",\n        value: \"oklch(0.922 0 0)\",\n      },\n      {\n        name: \"Neutral 500\",\n        className: \"neutral-500\",\n        value: \"oklch(0.556 0 0)\",\n      },\n      {\n        name: \"Neutral 900\",\n        className: \"neutral-900\",\n        value: \"oklch(0.205 0 0)\",\n      },\n    ],\n  },\n  {\n    name: \"Blue\",\n    colors: [\n      {\n        name: \"Blue 50\",\n        className: \"blue-50\",\n        value: \"oklch(0.97 0.014 254.604)\",\n      },\n      {\n        name: \"Blue 500\",\n        className: \"blue-500\",\n        value: \"oklch(0.623 0.214 259.815)\",\n      },\n      {\n        name: \"Blue 600\",\n        className: \"blue-600\",\n        value: \"oklch(0.546 0.245 262.881)\",\n      },\n    ],\n  },\n];\n\ninterface ColorItem {\n  name: string;\n  className: string;\n  value: string;\n}\n\nfunction CommandMenuItem({\n  children,\n  className,\n  onHighlight,\n  ...props\n}: React.ComponentProps<typeof CommandItem> & {\n  onHighlight?: () => void;\n}) {\n  const ref = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const element = ref.current;\n    if (!element) return;\n\n    const observer = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        if (\n          mutation.type === \"attributes\" &&\n          mutation.attributeName === \"aria-selected\" &&\n          element.getAttribute(\"aria-selected\") === \"true\"\n        ) {\n          onHighlight?.();\n        }\n      });\n    });\n\n    observer.observe(element, { attributes: true });\n    return () => observer.disconnect();\n  }, [onHighlight]);\n\n  return (\n    <CommandItem\n      ref={ref}\n      className={cn(\n        \"h-9 rounded-md border border-transparent !px-3 font-medium data-[selected=true]:border-input data-[selected=true]:bg-input/50\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </CommandItem>\n  );\n}\n\nfunction CommandMenuKbd({ className, ...props }: React.ComponentProps<\"kbd\">) {\n  return (\n    <kbd\n      className={cn(\n        \"pointer-events-none flex h-5 select-none items-center justify-center gap-1 rounded border bg-background px-1 font-sans text-[0.7rem] font-medium text-muted-foreground [&_svg:not([class*='size-'])]:size-3\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nexport function CommandMenu03() {\n  const router = useRouter();\n  const [open, setOpen] = useState(true);\n  const [selectedType, setSelectedType] = useState<\"page\" | \"color\" | null>(\n    null\n  );\n  const [copyPayload, setCopyPayload] = useState(\"\");\n\n  const copyToClipboard = useCallback((text: string) => {\n    navigator.clipboard.writeText(text);\n  }, []);\n\n  const runCommand = useCallback((command: () => unknown) => {\n    setOpen(false);\n    command();\n  }, []);\n\n  const handlePageHighlight = useCallback(\n    (isComponent: boolean, href: string) => {\n      setSelectedType(\"page\");\n      if (isComponent) {\n        const componentName = href.split(\"/\").pop();\n        setCopyPayload(`pnpm dlx shadcn@latest add ${componentName}`);\n      } else {\n        setCopyPayload(\"\");\n      }\n    },\n    []\n  );\n\n  const handleColorHighlight = useCallback((color: ColorItem) => {\n    setSelectedType(\"color\");\n    setCopyPayload(color.className);\n  }, []);\n\n  useEffect(() => {\n    const down = (e: KeyboardEvent) => {\n      if ((e.key === \"k\" && (e.metaKey || e.ctrlKey)) || e.key === \"/\") {\n        if (\n          (e.target instanceof HTMLElement && e.target.isContentEditable) ||\n          e.target instanceof HTMLInputElement ||\n          e.target instanceof HTMLTextAreaElement ||\n          e.target instanceof HTMLSelectElement\n        ) {\n          return;\n        }\n        e.preventDefault();\n        setOpen((open) => !open);\n      }\n\n      if (e.key === \"c\" && (e.metaKey || e.ctrlKey) && open && copyPayload) {\n        copyToClipboard(copyPayload);\n      }\n    };\n\n    document.addEventListener(\"keydown\", down);\n    return () => document.removeEventListener(\"keydown\", down);\n  }, [copyPayload, open, copyToClipboard]);\n\n  return (\n    <>\n      <Button variant=\"outline\" onClick={() => setOpen(true)}>\n        Open Command Menu\n      </Button>\n\n      <Dialog open={open} onOpenChange={setOpen}>\n        <DialogContent className=\"rounded-xl border-none bg-clip-padding p-2 pb-11 shadow-2xl ring-4 ring-neutral-200/80 dark:bg-neutral-900 dark:ring-neutral-800\">\n          <DialogHeader className=\"sr-only\">\n            <DialogTitle>Search documentation...</DialogTitle>\n            <DialogDescription>\n              Search for a command to run...\n            </DialogDescription>\n          </DialogHeader>\n\n          <Command className=\"rounded-none bg-transparent **:data-[slot=command-input-wrapper]:mb-0 **:data-[slot=command-input-wrapper]:!h-9 **:data-[slot=command-input-wrapper]:rounded-md **:data-[slot=command-input-wrapper]:border **:data-[slot=command-input-wrapper]:border-input **:data-[slot=command-input-wrapper]:bg-input/50 **:data-[slot=command-input]:!h-9 **:data-[slot=command-input]:py-0\">\n            <CommandInput placeholder=\"Search documentation...\" />\n            <CommandList className=\"no-scrollbar min-h-80 scroll-pb-1.5 scroll-pt-2\">\n              <CommandEmpty className=\"py-12 text-center text-sm text-muted-foreground\">\n                No results found.\n              </CommandEmpty>\n\n              {navItems.length > 0 && (\n                <CommandGroup\n                  heading=\"Pages\"\n                  className=\"!p-0 [&_[cmdk-group-heading]]:!p-3 [&_[cmdk-group-heading]]:!pb-1 [&_[cmdk-group-heading]]:scroll-mt-16\"\n                >\n                  {navItems.map((item) => (\n                    <CommandMenuItem\n                      key={item.href}\n                      value={`Navigation ${item.label}`}\n                      keywords={item.keywords}\n                      onHighlight={() => {\n                        setSelectedType(\"page\");\n                        setCopyPayload(\"\");\n                      }}\n                      onSelect={() => {\n                        runCommand(() => router.push(item.href));\n                      }}\n                    >\n                      <IconArrowRight aria-hidden=\"true\" className=\"size-4\" />\n                      {item.label}\n                    </CommandMenuItem>\n                  ))}\n                </CommandGroup>\n              )}\n\n              {pageGroups.map((group) => (\n                <CommandGroup\n                  key={group.name}\n                  heading={group.name}\n                  className=\"!p-0 [&_[cmdk-group-heading]]:!p-3 [&_[cmdk-group-heading]]:!pb-1 [&_[cmdk-group-heading]]:scroll-mt-16\"\n                >\n                  {group.pages.map((page) => {\n                    const isComponent = page.href.includes(\"/components/\");\n                    return (\n                      <CommandMenuItem\n                        key={page.href}\n                        value={`${group.name} ${page.name}`}\n                        keywords={page.keywords}\n                        onHighlight={() =>\n                          handlePageHighlight(isComponent, page.href)\n                        }\n                        onSelect={() => {\n                          runCommand(() => router.push(page.href));\n                        }}\n                      >\n                        {isComponent ? (\n                          <div className=\"aspect-square size-4 rounded-full border border-dashed border-muted-foreground\" />\n                        ) : (\n                          <IconArrowRight\n                            aria-hidden=\"true\"\n                            className=\"size-4\"\n                          />\n                        )}\n                        {page.name}\n                      </CommandMenuItem>\n                    );\n                  })}\n                </CommandGroup>\n              ))}\n\n              {colorGroups.map((colorGroup) => (\n                <CommandGroup\n                  key={colorGroup.name}\n                  heading={colorGroup.name}\n                  className=\"!p-0 [&_[cmdk-group-heading]]:!p-3\"\n                >\n                  {colorGroup.colors.map((color) => (\n                    <CommandMenuItem\n                      key={color.className}\n                      value={color.className}\n                      keywords={[\"color\", color.name, color.className]}\n                      onHighlight={() => handleColorHighlight(color)}\n                      onSelect={() => {\n                        runCommand(() => copyToClipboard(color.value));\n                      }}\n                    >\n                      <div\n                        className=\"aspect-square size-4 rounded-sm border\"\n                        style={{ backgroundColor: color.value }}\n                      />\n                      {color.className}\n                      <span className=\"ml-auto font-mono text-xs font-normal tabular-nums text-muted-foreground\">\n                        {color.value}\n                      </span>\n                    </CommandMenuItem>\n                  ))}\n                </CommandGroup>\n              ))}\n            </CommandList>\n          </Command>\n\n          <div className=\"absolute inset-x-0 bottom-0 z-20 flex h-10 items-center gap-2 rounded-b-xl border-t border-t-neutral-100 bg-neutral-50 px-4 text-xs font-medium text-muted-foreground dark:border-t-neutral-700 dark:bg-neutral-800\">\n            <div className=\"flex items-center gap-2\">\n              <CommandMenuKbd>\n                <IconCornerDownLeft aria-hidden=\"true\" className=\"size-3\" />\n              </CommandMenuKbd>\n              {selectedType === \"page\" && \"Go to Page\"}\n              {selectedType === \"color\" && \"Copy Value\"}\n              {!selectedType && \"Select\"}\n            </div>\n            {copyPayload && (\n              <>\n                <Separator orientation=\"vertical\" className=\"h-4!\" />\n                <div className=\"flex items-center gap-1\">\n                  <CommandMenuKbd>âŒ˜</CommandMenuKbd>\n                  <CommandMenuKbd>C</CommandMenuKbd>\n                  <span className=\"max-w-48 truncate\">{copyPayload}</span>\n                </div>\n              </>\n            )}\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}\n"
    }
  ],
  "categories": [
    "command-menu"
  ]
}